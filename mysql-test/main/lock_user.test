#
# Test user account locking
#

create user user1@localhost;
create user user2@localhost;

--echo #
--echo # Only SUPER_ACL privileged users should be able to lock/unlock.
--echo #
lock user user1@localhost;
unlock user user1@localhost;

connect(con1,localhost,user1,,);
connection con1;
--error ER_SPECIFIC_ACCESS_DENIED_ERROR
lock user user2@localhost;
disconnect con1;
connection default;

--echo #
--echo # LOCK USER USER1 should deny the connection of user1,
--echo # but it should allow user2 to connect.
--echo #

lock user user1@localhost;
--error ER_LOCKED_ACCOUNT
connect(con1,localhost,user1,,);
connect(con2,localhost,user2,,);
disconnect con2;
connection default;

--echo #
--echo # A user shouldn't be able to lock itself out
--echo #
lock user user1@localhost;
unlock user user1@localhost;

connect(conr,localhost,root,,);
connection conr;
--error ER_CANNOT_USER
lock user root@localhost;
disconnect conr;
connection default;

